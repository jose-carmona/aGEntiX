[pytest]
# ==============================================================================
# Configuración de pytest para aGEntiX
# ==============================================================================

# Directorios donde buscar tests
testpaths = tests

# Patrón de archivos de test
python_files = test_*.py

# Patrón de clases de test
python_classes = Test*

# Patrón de funciones de test
python_functions = test_*

# ==============================================================================
# Asyncio Configuration
# ==============================================================================
# pytest-asyncio: usa modo strict para detectar errores
asyncio_mode = strict
asyncio_default_fixture_loop_scope = function

# ==============================================================================
# Markers
# ==============================================================================
markers =
    unit: Tests unitarios (no requieren servicios externos)
    integration: Tests de integración (requieren servicios externos)
    slow: Tests que tardan más de 1 segundo
    mcp: Tests del MCP mock server
    api: Tests de la API REST
    backoffice: Tests del motor de agentes

# ==============================================================================
# Output Configuration
# ==============================================================================
# Mostrar resumen de todos los tipos de resultados
addopts =
    --strict-markers
    --tb=short
    --disable-warnings
    -ra

# ==============================================================================
# Warning Filters
# ==============================================================================
# Filtrar warnings conocidos de dependencias
filterwarnings =
    # Ignorar deprecation warnings de Pydantic v2 (TODO: migrar a v2 syntax)
    ignore::pydantic.warnings.PydanticDeprecatedSince20
    ignore::pydantic.PydanticDeprecatedSince20
    # Ignorar deprecation warnings de Starlette
    ignore::DeprecationWarning:starlette.routing
    # Nota: Cuando se migre a Pydantic v2, descomentar estas líneas para
    # detectar deprecations en nuestro código:
    # error::DeprecationWarning:backoffice.*
    # error::DeprecationWarning:api.*
    # error::DeprecationWarning:mcp_mock.*

# ==============================================================================
# Coverage Configuration (si se usa con --cov)
# ==============================================================================
# Configuración para pytest-cov
# Uso: pytest --cov=src --cov-report=html

# ==============================================================================
# Logging
# ==============================================================================
# Configuración de logging durante tests
log_cli = false
log_cli_level = INFO
log_file = logs/test.log
log_file_level = DEBUG
